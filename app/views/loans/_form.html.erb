<%= form_with(model: loan, class: "p-3") do |form| %>
  <% if loan.errors.any? %>
    <div>
      <% loan.errors.each do |error| %>
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
          <%= image_tag("icons/exclamation-triangle.svg", alt: "exclamation-triangle") %>
          <%= error.message %>
        </div>
      <% end %>
    </div>
  <% end %>

  <div>
    <%= form.label :loan_date, "Fecha de prÃ©stamo", style: "display: block" %>
    <%= form.date_field :loan_date, class:"form-control mb-3" %>
  </div>

  <% if action_name == "edit" %>
    <div>
      <%= form.label :return_date, style: "display: block" %>
      <%= form.date_field :return_date, class:"form-control mb-3" %>
    </div>
  <% end %>

  <div>
    <%= form.label :book_id, style: "display: block" %>
    <%= form.collection_select :book_id, @available_books, :id, :title, { disabled: action_name == "edit" }, class: "form-select mb-3" %>
  </div>

  <div>
    <%= form.label :expected_return_date, style: "display: block" %>
    <%= form.date_field :expected_return_date, class:"form-control mb-3" %>
  </div>

  <div>
    <%= form.label :user_id, style: "display: block" %>
    <% if action_name == "new" %>
     <%= form.collection_select :user_id, @users_without_pending_loans, :id, :dni, class:"form-select mb-3" %>
    <% else %>
      <%= form.text_field :user_id, value: @loan.user.dni, readonly: true, class:"form-control mb-3" %>
    <% end %>
  </div>

  <div>
    <%= form.submit %>
  </div>
<% end %>
